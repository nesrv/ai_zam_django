{% extends 'base/base.html' %}

{% block title %}–†–µ–¥–∞–∫—Ç–æ—Ä –¥–æ–∫—É–º–µ–Ω—Ç–∞ - {{ doc_title }}{% endblock %}

{% block extra_styles %}
.editor-container {
    max-width: 1400px;
    margin: 0 auto;
    background: rgba(255, 255, 255, 0.1);
    backdrop-filter: blur(10px);
    padding: 20px;
    border-radius: 15px;
    border: 1px solid rgba(255, 255, 255, 0.2);
}

.editor-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 20px;
    padding-bottom: 15px;
    border-bottom: 1px solid rgba(255, 255, 255, 0.2);
}

.editor-title {
    color: white;
    font-size: 24px;
    margin: 0;
}

.editor-actions {
    display: flex;
    gap: 10px;
}

.btn {
    background: rgba(255, 255, 255, 0.2);
    color: white;
    padding: 10px 20px;
    border: 1px solid rgba(255, 255, 255, 0.3);
    border-radius: 5px;
    text-decoration: none;
    cursor: pointer;
    transition: all 0.3s;
}

.btn:hover {
    background: rgba(255, 255, 255, 0.3);
    color: white;
    text-decoration: none;
}

.btn-save {
    background: rgba(0, 150, 0, 0.8);
}

.btn-save:hover {
    background: rgba(0, 150, 0, 1);
}

.editor-content {
    height: 70vh;
}

.preview-panel {
    background: rgba(255, 255, 255, 0.05);
    border-radius: 10px;
    padding: 15px;
    border: 1px solid rgba(255, 255, 255, 0.1);
    height: 100%;
}

.panel-title {
    color: white;
    font-size: 16px;
    margin-bottom: 10px;
    padding-bottom: 5px;
    border-bottom: 1px solid rgba(255, 255, 255, 0.2);
}

.preview-frame {
    width: 100%;
    height: calc(100% - 40px);
    border: 1px solid rgba(255, 255, 255, 0.2);
    border-radius: 5px;
    background: white;
}

.employee-info {
    background: rgba(255, 255, 255, 0.1);
    padding: 10px;
    border-radius: 5px;
    margin-bottom: 20px;
    color: white;
    font-size: 14px;
}
{% endblock %}

{% block content %}
<div class="editor-container">
    <div class="employee-info">
        <strong>–°–æ—Ç—Ä—É–¥–Ω–∏–∫:</strong> {{ sotrudnik.fio }} | 
        <strong>–°–ø–µ—Ü–∏–∞–ª—å–Ω–æ—Å—Ç—å:</strong> {{ sotrudnik.specialnost|default:"–ù–µ —É–∫–∞–∑–∞–Ω–∞" }}
    </div>

    <div class="editor-header">
        <h1 class="editor-title">{{ doc_title }}</h1>
        <div class="editor-actions">
            <button class="btn" onclick="printDocument()">üñ®Ô∏è –ü–µ—á–∞—Ç—å</button>
            <a href="/sotrudniki/{{ sotrudnik.id }}/documents/" class="btn">‚Üê –ù–∞–∑–∞–¥</a>
        </div>
    </div>

    <div class="editor-content">
        <div class="preview-panel">
            <div class="panel-title">–ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä</div>
            <iframe id="preview-frame" class="preview-frame"></iframe>
        </div>
    </div>
</div>

<script>
function printDocument() {
    const previewFrame = document.getElementById('preview-frame');
    previewFrame.contentWindow.print();
}

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ–≥–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞
document.addEventListener('DOMContentLoaded', function() {
    const htmlContent = `{{ html_content|escapejs }}`;
    const previewFrame = document.getElementById('preview-frame');
    const doc = previewFrame.contentDocument || previewFrame.contentWindow.document;
    doc.open();
    doc.write(htmlContent);
    doc.close();
});
</script>
{% endblock %}